(()=>{"use strict";var e={pageSelector:".page",openedPopupClass:"popup_opened",openedPopupSelector:".popup_opened",profileSectionSelector:".profile",pageButtonSelector:".page__button",pageButtonClass:"page__button",profileAvatar:".profile__avatar",profileTitleSelector:".profile__title",profileSubtitleSelector:".profile__subtitle",cardSectionSelector:".elements",popupSelector:".popup",formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-save",inactiveButtonClass:"popup__button-save_disabled",closeButtonClass:"popup__button-close",closeButtonSelector:".popup__button-close",popupInputErrorClass:"popup__input_error",inputErrorClass:"popup__input-error_type_",errorClass:"popup__input-error_active",popupChangeProfileClass:"popup_change-profile",popupChangeProfileSelector:".popup_change-profile",popupChangeProfileInputNameSelector:".popup__input_profile-name",popupChangeProfileInputSigningSelector:".popup__input_profile-signing",submitButtonChangeProfileSelector:".popup__button-save_change-profile",popupAddCardClass:"popup_add-card",popupAddCardSelector:".popup_add-card",popupAddCardinputLocationNameSelector:".popup__input_location-name",popupAddCardinputImageLinkSelector:".popup__input_image-link",profileChangeButtonSelector:".profile__change-button",cardAddButtonSelector:".profile__add-button",submitButtonAddNewCardSelector:".popup__button-save_add-card",popupOpenImageSelector:".popup_open-image",popupOpenImageImageSelector:".popup__image",popupOpenImageFigcaptionSelector:".popup__figcaption",popupDeletionConfirmSelector:".popup_confirm-deletion",popupChangeAvatarSelector:".popup_avatar",sectionElementSelector:".elements",templateElementSelector:".template-element",templateCardBodySelector:".element",templateImageClass:"element__image",templateImageSelector:".element__image",templateCardTitleSelector:".element__card-title",templateDeleteButtonSelector:".element__button-delete",templateLikeButtonSelector:".element__button-like",cardLikeCounterSelector:".element__like-counter",LikedButtonSelector:".button-like_active",DislikedButtonSelector:".button-like_disabled",LikedButtonClass:"button-like_active",DislikedButtonClass:".button-like_disabled"},t=document.querySelector(e.pageSelector),n=t.querySelector(e.popupChangeProfileSelector),o=t.querySelector(e.profileAvatar),r=t.querySelector(e.profileChangeButtonSelector),i=t.querySelector(e.cardAddButtonSelector),a=n.querySelector(e.popupChangeProfileInputNameSelector),l=n.querySelector(e.popupChangeProfileInputSigningSelector),c=t.querySelector(e.sectionElementSelector);function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=function(){function t(e,n,o,r,i,a){var l=e.name,c=e.link,u=e.likes,s=e.owner,p=e._id;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=l,this._link=c,this._likes=u,this._likesLength=u.length,this._owner=s,this.ownerId=s._id,this.userId=n,this.cardId=p,this._handleCardClick=o,this._handleDeleteCard=r,this._handleAddLike=i,this._handledeleteLike=a,this._handleDeleteCardBind=this._handleDeleteCard.bind(this),this._likeCardBind=this._likeCard.bind(this),this._handleCardClickBind=this._handleCardClick.bind(this)}var n,o;return n=t,(o=[{key:"generateCard",value:function(){return this._cardElement=this._getTemplate(),this._setEventListeners(this._cardElement),this._cardElement.querySelector(e.templateImageSelector).src=this._link,this._cardElement.querySelector(e.templateImageSelector).alt="Картинка ".concat(this._name),this._cardElement.querySelector(e.templateCardTitleSelector).textContent=this._name,this._cardElement.querySelector(e.cardLikeCounterSelector).textContent=this._likesLength,this.ownerId!==this.userId&&(this._cardElement.querySelector(e.templateDeleteButtonSelector).style.display="none"),this._isCardLikedinServer(this._likes)?this._likeButton(this._cardElement):this._dislikeButton(this._cardElement),this._cardElement.style.animationDelay=".2s",this._cardElement}},{key:"_getTemplate",value:function(){return document.querySelector(e.templateElementSelector).content.querySelector(e.templateCardBodySelector).cloneNode(!0)}},{key:"_setEventListeners",value:function(t){var n=this;if(this.ownerId===this.userId){var o=t.querySelector(e.templateDeleteButtonSelector),r=t.querySelector(".element__figcaption");o.addEventListener("click",(function(e){return n._handleDeleteCardBind(r)}))}t.querySelector(e.templateLikeButtonSelector).addEventListener("click",(function(e){return n._likeCardBind(t)})),t.querySelector(e.templateImageSelector).addEventListener("click",(function(){n._handleCardClickBind(n._name,n._link)}))}},{key:"_likeButton",value:function(t){t.querySelector(e.templateLikeButtonSelector).classList.add(e.LikedButtonClass)}},{key:"_dislikeButton",value:function(t){t.querySelector(e.templateLikeButtonSelector).classList.remove(e.LikedButtonClass)}},{key:"_isCardLikedinServer",value:function(e){var t=[];return e.forEach((function(e){return t.push(e._id),t})),t.includes(this.userId)}},{key:"_isCardLikedInDom",value:function(t){return!!t.querySelector(e.templateLikeButtonSelector).classList.contains(e.LikedButtonClass)}},{key:"_likeCounter",value:function(t,n){t.querySelector(e.cardLikeCounterSelector).textContent=n}},{key:"_addLikeToCardByApi",value:function(t){var n=this;this._handleAddLike({cardId:this.cardId,likes:{name:this._owner.name,about:this._owner.about,avatar:this._owner.avatar,_id:this._owner._id,cohort:this._owner.cohort}}).then((function(o){console.log("карточку не лайкал. Лайк поставлен",o),console.log("лайк поставлен - result.likes.length",o.likes.length),n._likeCounter(t,o.likes.length),console.log("лайк поставлен - кол-во в счетчике",t.querySelector(e.cardLikeCounterSelector).textContent)})).catch((function(e){console.log("карточку не лайкал. ошибка:",e)}))}},{key:"_removeLikeToCardByApi",value:function(t){var n=this;this._handledeleteLike({cardId:this.cardId,likes:{name:this._owner.name,about:this._owner.about,avatar:this._owner.avatar,_id:this._owner._id,cohort:this._owner.cohort}}).then((function(o){console.log("карточку лайкал уже. Лайк убран",o),console.log("лайк убран - result.likes.length",o.likes.length),n._likeCounter(t,o.likes.length),console.log("лайк убран - кол-во в счетчике",t.querySelector(e.cardLikeCounterSelector).textContent)})).catch((function(e){console.log("карточку лайкал уже. ошибка:",e)}))}},{key:"_likeCard",value:function(e){this._isCardLikedInDom(e)?(this._dislikeButton(e),this._removeLikeToCardByApi(e)):(this._likeButton(e),this._addLikeToCardByApi(e))}}])&&u(n.prototype,o),t}();function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var f=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=t,this._form=n,this._inputList=Array.from(this._form.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._form.querySelector(this._config.submitButtonSelector),this._checkInputValidityBind=this._checkInputValidity.bind(this),this.toggleButtonStateBind=this.toggleButtonState.bind(this)}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"hideInputErrors",value:function(){var e=this;this._inputList.forEach((function(t){e._hideInputError(t)}))}},{key:"_setEventListeners",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidityBind(t),e.toggleButtonStateBind()}))}))}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}},{key:"_showInputError",value:function(e){var t=e.validationMessage,n=this._form.querySelector(".".concat(this._config.inputErrorClass).concat(e.name));n.textContent=t,e.classList.add(this._config.popupInputErrorClass),n.classList.add(this._config.errorClass)}},{key:"_hideInputError",value:function(e){var t=this._form.querySelector(".".concat(this._config.inputErrorClass).concat(e.name));t.textContent="",e.classList.remove(this._config.popupInputErrorClass),t.classList.remove(this._config.errorClass)}},{key:"toggleButtonState",value:function(){this._inputList.some((function(e){return!e.validity.valid}))?(this._buttonElement.setAttribute("disabled",!0),this._buttonElement.classList.add(this._config.inactiveButtonClass)):(this._buttonElement.removeAttribute("disabled"),this._buttonElement.classList.remove(this._config.inactiveButtonClass))}}])&&p(t.prototype,n),e}();function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var h=function(){function e(t,n){var o=t.items,r=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._initialСardsData=o,this._renderer=r,this._sectionForAddition=n}var t,n;return t=e,(n=[{key:"renderItems",value:function(){var e=this;this._initialСardsData.forEach((function(t){e._renderer(t)}))}},{key:"appendItem",value:function(e){this._sectionForAddition.append(e)}},{key:"prependItem",value:function(e){this._sectionForAddition.prepend(e)}}])&&d(t.prototype,n),e}();function _(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var m=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._popupElement=document.querySelector(e),this._handleEscCloseBind=this._handleEscClose.bind(this),this._handleClickCloseBind=this._handleClickClose.bind(this)}var n,o;return n=t,(o=[{key:"open",value:function(){var t=this;this._popupElement.classList.add("popup__flexed"),setTimeout((function(){t._popupElement.classList.add(e.openedPopupClass)}),0),document.addEventListener("keyup",this._handleEscCloseBind)}},{key:"close",value:function(){this._popupElement.classList.remove(e.openedPopupClass),document.removeEventListener("keyup",this._handleEscCloseBind)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"_handleClickClose",value:function(t){t.target.classList.contains(e.openedPopupClass)&&this.close(),t.target.classList.contains(e.closeButtonClass)&&this.close()}},{key:"setEventListeners",value:function(){this._popupElement.addEventListener("click",this._handleClickCloseBind)}}])&&_(n.prototype,o),t}();function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function k(e,t,n){return(k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?S(e):t}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(l,t);var n,o,r,i,a=(r=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=C(r);if(i){var n=C(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function l(t){var n,o=t.popupSelector,r=t.handleForm;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=a.call(this,o))._handleForm=r,n._popupForm=n._popupElement.querySelector(e.formSelector),n.submitButton=n._popupElement.querySelector(e.submitButtonSelector),n.submitButtonInitialText=n._popupElement.querySelector(e.submitButtonSelector).textContent,n._AllPopupFormInputs=n._popupForm.querySelectorAll(e.inputSelector),n._handleFormSubmitBind=n._handleFormSubmit.bind(S(n)),n}return n=l,(o=[{key:"_getInputValues",value:function(){var e=this;return this._formInputValues={},this._AllPopupFormInputs.forEach((function(t){e._formInputValues[t.name]=t.value})),this._formInputValues}},{key:"_handleFormSubmit",value:function(e){e.preventDefault(),this._formInputValues=this._getInputValues(),this._handleForm(this._formInputValues)}},{key:"setEventListeners",value:function(){k(C(l.prototype),"setEventListeners",this).call(this),this._popupForm.addEventListener("submit",this._handleFormSubmitBind)}},{key:"close",value:function(){k(C(l.prototype),"close",this).call(this),this._popupForm.reset()}}])&&y(n.prototype,o),l}(m);function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function L(e,t,n){return(L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e,t){return!t||"object"!==B(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(l,t);var n,o,r,i,a=(r=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=O(r);if(i){var n=O(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return P(this,e)});function l(t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=a.call(this,t))._popupImage=n._popupElement.querySelector(e.popupOpenImageImageSelector),n._popupFigcaption=n._popupElement.querySelector(e.popupOpenImageFigcaptionSelector),n}return n=l,(o=[{key:"open",value:function(e,t){L(O(l.prototype),"open",this).call(this),this._addContentToPopup(e,t)}},{key:"_addContentToPopup",value:function(e,t){this._popupImage.src=t,this._popupImage.alt="картинка ".concat(e),this._popupFigcaption.textContent=e}}])&&I(n.prototype,o),l}(m);function A(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var j=function(){function e(t){var n=t.profileTitleSelector,o=t.profileSubtitleSelector,r=t.avatar;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._profileTitle=document.querySelector(n),this._profileSubtitle=document.querySelector(o),this._profileAvatar=document.querySelector(r)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){var e={};return e.inputName=this._profileTitle.textContent,e.inputSigning=this._profileSubtitle.textContent,e}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.signing;this._profileTitle.textContent=t,this._profileSubtitle.textContent=n}},{key:"setUserAvatar",value:function(e){this._profileAvatar.src=e}}])&&A(t.prototype,n),e}();function q(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var x=new(function(){function e(t){var n=t.serverUrl,o=t.cohort,r=t.token;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._serverUrl=n,this._cohort=o,this._token=r}var t,n;return t=e,(n=[{key:"getPromiseAll",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=[].concat(t);return Promise.all(o)}},{key:"getUserInfo",value:function(){return fetch("".concat(this._serverUrl,"/").concat(this._cohort,"/users/me"),{headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))}))}},{key:"getCards",value:function(){return fetch("".concat(this._serverUrl,"/").concat(this._cohort,"/cards"),{headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))}))}},{key:"sendUserInfo",value:function(e){var t=e.newName,n=e.newAbout;return fetch("".concat(this._serverUrl,"/").concat(this._cohort,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("ошибка ".concat(e.status))}))}},{key:"sendNewCard",value:function(e){var t=e.name,n=e.link;return fetch("".concat(this._serverUrl,"/").concat(this._cohort,"/cards"),{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:n})}).then((function(e){return e.ok?e.json():Promise.reject("ошибка ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._serverUrl,"/").concat(this._cohort,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({_id:e})}).then((function(e){return e.ok?e.json():Promise.reject("ошибка ".concat(e.status))}))}},{key:"addLikeCard",value:function(e){var t=e.cardId,n=e.likes;return fetch("".concat(this._serverUrl,"/").concat(this._cohort,"/cards/likes/").concat(t),{method:"PUT",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({_id:t,likes:n})}).then((function(e){return e.ok?e.json():Promise.reject("ошибка ".concat(e.status))}))}},{key:"deleteLikeCard",value:function(e){var t=e.cardId,n=e.likes;return fetch("".concat(this._serverUrl,"/").concat(this._cohort,"/cards/likes/").concat(t),{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({_id:t,likes:n})}).then((function(e){return e.ok?e.json():Promise.reject("ошибка ".concat(e.status))}))}},{key:"sendUserAvatar",value:function(e){var t=e.newAvatarLink;return fetch("".concat(this._serverUrl,"/").concat(this._cohort,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("ошибка ".concat(e.status))}))}}])&&q(t.prototype,n),e}())({serverUrl:"https://mesto.nomoreparties.co/v1",cohort:"cohort-22",token:"a039ff03-9c34-4fce-91e0-77cd409474e3"});x.getPromiseAll(x.getUserInfo(),x.getCards()).then((function(e){console.log("Promise.all - массив результат",e),console.log("получаем данные профиля по api и отображаем их на странице:ok",e[0]),M.setUserInfo({name:e[0].name,signing:e[0].about}),M.setUserAvatar(e[0].avatar),console.log("api-получаем изначальные карточки для отображения-результат-все карточки сервера:ok",e[1]),console.log("api-получаем айди нашего пользователя для сбора карточки-результат-b939b1d8959802541ab0c34b:ok",e[0]._id);var t=N({items:e[1],renderer:function(n){var o=R(n,e[0]._id);t.appendItem(o)}},c);t.renderItems()})).catch((function(e){console.log("Promise.all - ошибка",e),console.log("получаем данные профиля по api и отображаем их на странице и api-получаем изначальные карточки для отображения-результат-все карточки сервера:error",e)}));var U=null,F=null,D=new E({popupSelector:e.popupDeletionConfirmSelector,handleForm:function(){G(D.submitButton,D.submitButtonInitialText,!0),x.deleteCard(U._id).then((function(t){F.closest(e.templateCardBodySelector).remove(),D.close()})).catch((function(e){console.log("PopupDeleteCard - удаление: error",e)})).finally((function(){G(D.submitButton,D.submitButtonInitialText,!1)}))}});function R(e,t){var n=x.deleteLikeCard.bind(x),o=x.addLikeCard.bind(x),r=V.open.bind(V);return new s(e,t,r,(function(t){D.open(),U=e,F=t}),o,n).generateCard()}function N(e,t){return new h({items:e.items,renderer:e.renderer},t)}var V=new T(e.popupOpenImageSelector),z=new E({popupSelector:e.popupAddCardSelector,handleForm:function(e){G(z.submitButton,z.submitButtonInitialText,!0),x.sendNewCard({name:e["location-name"],link:e["image-link"]}).then((function(e){console.log("api-попап добавления карточки-результат-новая карточка: ok",e),console.log("api-попап добавления карточки-результат-cardInfo.owner._id = b939b1d8959802541ab0c34b",e.owner._id);var t=R(e,e.owner._id);N({items:e,renderer:function(){}},c).prependItem(t),z.close()})).catch((function(e){console.log("api-попап добавления карточки-результат-новая карточка: error",e)})).finally((function(){G(z.submitButton,z.submitButtonInitialText,!1)}))}}),J=new E({popupSelector:e.popupChangeAvatarSelector,handleForm:function(e){G(J.submitButton,J.submitButtonInitialText,!0),x.sendUserAvatar({newAvatarLink:e["image-link"]}).then((function(e){console.log("api-редактирование аватара: ok",e),M.setUserAvatar(e.avatar),J.close()})).catch((function(e){console.log("api-редактирование аватара: ok",e)})).finally((function(){G(J.submitButton,J.submitButtonInitialText,!1)}))}}),H=new E({popupSelector:e.popupChangeProfileSelector,handleForm:function(e){G(H.submitButton,H.submitButtonInitialText,!0),x.sendUserInfo({newName:e["profile-name"],newAbout:e["profile-signing"]}).then((function(e){console.log("api-редактирование профиля: ok",e),M.setUserInfo({name:e.name,signing:e.about}),H.close()})).catch((function(e){console.log("api-редактирование профиля: error",e)})).finally((function(){G(H.submitButton,H.submitButtonInitialText,!1)}))}}),M=new j({profileTitleSelector:e.profileTitleSelector,profileSubtitleSelector:e.profileSubtitleSelector,avatar:e.profileAvatar});function G(e,t,n){e.textContent=n?"Сохранение...":t}r.addEventListener("click",(function(){return e=M.getUserInfo(),a.value=e.inputName,l.value=e.inputSigning,void H.open();var e})),i.addEventListener("click",(function(){z.open()})),o.addEventListener("click",(function(){J.open()})),V.setEventListeners(),z.setEventListeners(),H.setEventListeners(),D.setEventListeners(),J.setEventListeners(),Array.from(document.querySelectorAll(e.formSelector)).forEach((function(n){if(t.querySelector(".".concat(n.name,"-open-button"))){var o=t.querySelector(".".concat(n.name,"-open-button")),r=new f(e,n);o.addEventListener("click",r.hideInputErrors.bind(r)),o.addEventListener("click",r.toggleButtonState.bind(r)),r.enableValidation()}}))})();